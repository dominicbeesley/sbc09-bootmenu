NEW
5 DIM B% 43
10 REM > SRECRUN load an SREC file to memory and run
15 ON ERROR GOTO 20
20 INPUT "SREC:", L$
30 IF LEN(L$) < 6 THEN PRINT "Bad SREC - too short :";L$:GOTO 20
40 IF MID$(L$,1,1)<>"S" THEN PRINT "Bad SREC no initial S : ";L$:GOTO 20
45 T$=MID$(L$,2,1):IF T$<"0" OR T$>"9" THEN PRINT "Bad SREC, unknown type : ";L$:GOTO20
50 C%=FNhex(MID$(L$,3,2)):IF C%<3 OR C%>43 THEN PRINT "Bad length : ";L$:GOTO 20
60 IF LEN(L$)<4+C%*2THENPRINT "Bad SREC - too short :";L$:GOTO20
65 K%=C%
70 FOR I%=0TOC%-2:X%=FNhex(MID$(L$,5+I%*2,2)):IF X%<0 THEN PRINT "Bad hex : ";L$:GOTO 20
80 K%=K%+X%
82 B%?I%=X%:NEXT
85 K%=255-(K% AND 255):CK%=FNhex(MID$(L$,3+C%*2,2))
90 IF K% <> CK% THEN PRINT "Bad checksum ";~K%;"<>";~CK%;" : ";L$:GOTO 20
95 A%=256*(B%?0)+B%?1:P.~A%
100 IF T$="0" THEN P. ~A%,MID$($B%,1,C%-3):GOTO20
110 IF T$="1" THEN A%=A%-2:FOR I%=2TOC%-1:A%?I%=B%?I%:NEXT:GOTO20
115 IF T$="9" THEN CALLA%:GOTO20
120 P."Unrecognized command "; T$
130 GOTO20
140:
1000DEFFNhex(H$)=EVAL("&"+H$)
RUN

S1230E00308C1B3384EFE3308D01301F10A3E1108E0800A6C0A7A0301F26F87E0800863AC7
S1230E20BDFFE3108E0600308D010910AF84C6FFE702CC207EED038600BDFFF1102500E40D
S1230E40108C000625608E0600A680812023FA815326531700A42553810A244AA78D00D270
S1230E606F8D00CD8D7725438103253A1F89A78D00C1318410AF8D00C08D62252EA7A05A15
S1230E8026F7A68D00AB4C2618AE8D00ACA68D00A1810127288109273D863FBDFFE316FFD6
S1230EA07D308C702008308C6E2003308C728D0316FF6BA6802705BDFFE320F7398677BDD7
S1230EC0FFE310AE84E68C6BC0033002A680A7A05A26F916FF488665BDFFE36E948D1B257C
S1230EE01849494949A7E28D11AAE0250CA7E2AB8C3FA78C3CA6E01CFE39A680803025137B
S1230F00810A250D8007810A2509811025031A01391CFE39434B005352454300457363009A
S11E0F2048455800308CF58D8A867EBDFFF416FEED0000000000000000000050
S9030E00EE
